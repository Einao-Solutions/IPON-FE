import{S as Me,i as He,s as Oe,m as je,o as Ae,p as B,q as S,r as E,u as Pe,w as L,y as M,z as H,l as Re,d,G as Fe,a as W,F as me,v as pe,b as y,c as h,x as b,e as w,f as D,h as A,g as O,j as k,k as P,t as R,a5 as qe,a6 as ze,I as ke,K as ve,n as Ie}from"./Cccy056x.js";import{e as _e}from"./ByixyIeQ.js";import"./IHki7fMi.js";import{L as ce}from"./C1SE41V3.js";import{b as Ee,T as ge}from"./Dx8SlrN2.js";import"./R6lDc60d.js";import{T as Je}from"./CXG556D5.js";import{R as Ge}from"./BbVspNW5.js";import"./Mi5ChQ-_.js";import{I as Ke}from"./CyluoF3k.js";import{c as re}from"./CKhnlzod.js";import{t as Te}from"./rg3ioSbs.js";import{T as Qe}from"./BIWCtR2V.js";import{l as We}from"./CuoJv0KR.js";import{I as Be}from"./DQ1KgJGZ.js";import{S as Xe}from"./C8XMDHA_.js";import{S as Ye}from"./hW00L5SN.js";import{B as Ze}from"./BCzZLC02.js";function Ce(r,e,t){const a=r.slice();return a[13]=e[t],a}function De(r,e,t){const a=r.slice();return a[16]=e[t],a}function Ue(r){let e;return{c(){e=R("Created by")},l(t){e=O(t,"Created by")},m(t,a){y(t,e,a)},d(t){t&&d(e)}}}function xe(r){let e;return{c(){e=R("Status")},l(t){e=O(t,"Status")},m(t,a){y(t,e,a)},d(t){t&&d(e)}}}function et(r){let e;return{c(){e=R("Date Created")},l(t){e=O(t,"Date Created")},m(t,a){y(t,e,a)},d(t){t&&d(e)}}}function tt(r){let e;return{c(){e=R("Title")},l(t){e=O(t,"Title")},m(t,a){y(t,e,a)},d(t){t&&d(e)}}}function Ne(r){let e,t,a,f;e=new ce({props:{$$slots:{default:[at]},$$scope:{ctx:r}}});let s=_e(r[0].affectedFiles),l=[];for(let n=0;n<s.length;n+=1)l[n]=Se(De(r,s,n));return{c(){H(e.$$.fragment),t=P(),a=k("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){M(e.$$.fragment,n),t=A(n),a=w(n,"DIV",{class:!0});var i=D(a);for(let _=0;_<l.length;_+=1)l[_].l(i);i.forEach(d),this.h()},h(){b(a,"class","grid grid-cols-2 text-sm")},m(n,i){L(e,n,i),y(n,t,i),y(n,a,i);for(let _=0;_<l.length;_+=1)l[_]&&l[_].m(a,null);f=!0},p(n,i){const _={};if(i&524288&&(_.$$scope={dirty:i,ctx:n}),e.$set(_),i&1){s=_e(n[0].affectedFiles);let u;for(u=0;u<s.length;u+=1){const g=De(n,s,u);l[u]?l[u].p(g,i):(l[u]=Se(g),l[u].c(),l[u].m(a,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=s.length}},i(n){f||(E(e.$$.fragment,n),f=!0)},o(n){S(e.$$.fragment,n),f=!1},d(n){n&&(d(t),d(a)),B(e,n),Fe(l,n)}}}function at(r){let e;return{c(){e=R("Affected Files")},l(t){e=O(t,"Affected Files")},m(t,a){y(t,e,a)},d(t){t&&d(e)}}}function Se(r){let e,t=r[16].fileNumber+"",a,f;return{c(){e=k("a"),a=R(t),this.h()},l(s){e=w(s,"A",{class:!0,href:!0});var l=D(e);a=O(l,t),l.forEach(d),this.h()},h(){b(e,"class","p-1 m-1 border rounded-md"),b(e,"href",f="/dataview?id="+r[16].id)},m(s,l){y(s,e,l),h(e,a)},p(s,l){l&1&&t!==(t=s[16].fileNumber+"")&&W(a,t),l&1&&f!==(f="/dataview?id="+s[16].id)&&b(e,"href",f)},d(s){s&&d(e)}}}function Ve(r){let e,t,a,f;return t=new Be({props:{icon:"typcn:attachment-outline",width:"1.2rem",height:"1.2rem"}}),{c(){e=k("a"),H(t.$$.fragment),this.h()},l(s){e=w(s,"A",{target:!0,href:!0});var l=D(e);M(t.$$.fragment,l),l.forEach(d),this.h()},h(){b(e,"target","_blank"),b(e,"href",a=r[13].attachment)},m(s,l){y(s,e,l),L(t,e,null),f=!0},p(s,l){(!f||l&1&&a!==(a=s[13].attachment))&&b(e,"href",a)},i(s){f||(E(t.$$.fragment,s),f=!0)},o(s){S(t.$$.fragment,s),f=!1},d(s){s&&d(e),B(t)}}}function ye(r){let e,t,a,f=r[13].message+"",s,l,n=re(r[13].dateAdded)+"",i,_,u,g,V=r[13].senderName+"",I,T,v,c,m=r[13].attachment&&Ve(r);return{c(){e=k("div"),t=k("div"),a=new ze(!1),s=P(),l=k("p"),i=R(n),_=P(),u=k("div"),g=k("p"),I=R(V),T=P(),m&&m.c(),this.h()},l($){e=w($,"DIV",{class:!0});var N=D(e);t=w(N,"DIV",{class:!0});var G=D(t);a=qe(G,!1),G.forEach(d),s=A(N),l=w(N,"P",{class:!0});var X=D(l);i=O(X,n),X.forEach(d),_=A(N),u=w(N,"DIV",{class:!0});var J=D(u);g=w(J,"P",{class:!0});var z=D(g);I=O(z,V),z.forEach(d),T=A(J),m&&m.l(J),J.forEach(d),N.forEach(d),this.h()},h(){a.a=null,b(t,"class","content"),b(l,"class","mt-2 opacity-60 text-sm"),b(g,"class","opacity-50 text-sm"),b(u,"class","flex justify-between"),b(e,"class",v="p-2 m-2 rounded-md "+(r[13].senderId===r[0].creatorId?"bg-green-300":"bg-gray-300")+" "+(r[13].senderId===r[0].creatorId?"justify-end":"justify-start"))},m($,N){y($,e,N),h(e,t),a.m(f,t),h(e,s),h(e,l),h(l,i),h(e,_),h(e,u),h(u,g),h(g,I),h(u,T),m&&m.m(u,null),c=!0},p($,N){(!c||N&1)&&f!==(f=$[13].message+"")&&a.p(f),(!c||N&1)&&n!==(n=re($[13].dateAdded)+"")&&W(i,n),(!c||N&1)&&V!==(V=$[13].senderName+"")&&W(I,V),$[13].attachment?m?(m.p($,N),N&1&&E(m,1)):(m=Ve($),m.c(),E(m,1),m.m(u,null)):m&&(me(),S(m,1,1,()=>{m=null}),pe()),(!c||N&1&&v!==(v="p-2 m-2 rounded-md "+($[13].senderId===$[0].creatorId?"bg-green-300":"bg-gray-300")+" "+($[13].senderId===$[0].creatorId?"justify-end":"justify-start")))&&b(e,"class",v)},i($){c||(E(m),c=!0)},o($){S(m),c=!1},d($){$&&d(e),m&&m.d()}}}function lt(r){let e,t,a="<p>Ticket closed, comments can&#39;t be added</p>",f,s,l,n=r[0].resolution.staffName+"",i,_,u,g=re(r[0].resolution.date)+"",V;return{c(){e=k("div"),t=k("div"),t.innerHTML=a,f=P(),s=k("p"),l=R("Closed by "),i=R(n),_=P(),u=k("p"),V=R(g),this.h()},l(I){e=w(I,"DIV",{class:!0});var T=D(e);t=w(T,"DIV",{class:!0,"data-svelte-h":!0}),ve(t)!=="svelte-16uw9v1"&&(t.innerHTML=a),f=A(T),s=w(T,"P",{class:!0});var v=D(s);l=O(v,"Closed by "),i=O(v,n),v.forEach(d),_=A(T),u=w(T,"P",{class:!0});var c=D(u);V=O(c,g),c.forEach(d),T.forEach(d),this.h()},h(){b(t,"class","flex justify-center w-full items-center"),b(s,"class","mt-2"),b(u,"class","text-sm font-light"),b(e,"class","flex flex-col w-full")},m(I,T){y(I,e,T),h(e,t),h(e,f),h(e,s),h(s,l),h(s,i),h(e,_),h(e,u),h(u,V)},p(I,T){T&1&&n!==(n=I[0].resolution.staffName+"")&&W(i,n),T&1&&g!==(g=re(I[0].resolution.date)+"")&&W(V,g)},i:Ie,o:Ie,d(I){I&&d(e)}}}function st(r){let e,t,a,f,s,l,n="attachment (optional)",i,_,u,g,V;function I(v){r[6](v)}let T={class:"min-h-16 mt-2",placeholder:"Enter text"};return r[2]!==void 0&&(T.value=r[2]),t=new Je({props:T}),je.push(()=>Ae(t,"value",I)),_=new Ke({props:{id:"picture",type:"file",class:"mt-3",accept:".pdf, .jpg, .png, .jpeg",multiple:!1}}),_.$on("change",r[7]),g=new Ze({props:{$$slots:{default:[rt]},$$scope:{ctx:r}}}),g.$on("click",r[8]),{c(){e=k("div"),H(t.$$.fragment),f=P(),s=k("div"),l=k("p"),l.textContent=n,i=P(),H(_.$$.fragment),u=P(),H(g.$$.fragment),this.h()},l(v){e=w(v,"DIV",{});var c=D(e);M(t.$$.fragment,c),f=A(c),s=w(c,"DIV",{class:!0});var m=D(s);l=w(m,"P",{class:!0,"data-svelte-h":!0}),ve(l)!=="svelte-mf66d6"&&(l.textContent=n),i=A(m),M(_.$$.fragment,m),u=A(m),M(g.$$.fragment,m),m.forEach(d),c.forEach(d),this.h()},h(){b(l,"class","opacity-50 text-sm"),b(s,"class","flex gap-2 mt-1 items-center")},m(v,c){y(v,e,c),L(t,e,null),h(e,f),h(e,s),h(s,l),h(s,i),L(_,s,null),h(s,u),L(g,s,null),V=!0},p(v,c){const m={};!a&&c&4&&(a=!0,m.value=v[2],Pe(()=>a=!1)),t.$set(m);const $={};c&524296&&($.$$scope={dirty:c,ctx:v}),g.$set($)},i(v){V||(E(t.$$.fragment,v),E(_.$$.fragment,v),E(g.$$.fragment,v),V=!0)},o(v){S(t.$$.fragment,v),S(_.$$.fragment,v),S(g.$$.fragment,v),V=!1},d(v){v&&d(e),B(t),B(_),B(g)}}}function rt(r){let e,t,a,f="Send",s;return e=new Be({props:{class:r[3]?"":"hidden",icon:"line-md:loading-loop",width:"1.2rem",height:"1.2rem"}}),{c(){H(e.$$.fragment),t=P(),a=k("p"),a.textContent=f},l(l){M(e.$$.fragment,l),t=A(l),a=w(l,"P",{"data-svelte-h":!0}),ve(a)!=="svelte-my8s8q"&&(a.textContent=f)},m(l,n){L(e,l,n),y(l,t,n),y(l,a,n),s=!0},p(l,n){const i={};n&8&&(i.class=l[3]?"":"hidden"),e.$set(i)},i(l){s||(E(e.$$.fragment,l),s=!0)},o(l){S(e.$$.fragment,l),s=!1},d(l){l&&(d(t),d(a)),B(e,l)}}}function nt(r){let e,t,a,f;const s=[st,lt],l=[];function n(i,_){return i[0].status!==ge.closed?0:1}return e=n(r),t=l[e]=s[e](r),{c(){t.c(),a=ke()},l(i){t.l(i),a=ke()},m(i,_){l[e].m(i,_),y(i,a,_),f=!0},p(i,_){let u=e;e=n(i),e===u?l[e].p(i,_):(me(),S(l[u],1,1,()=>{l[u]=null}),pe(),t=l[e],t?t.p(i,_):(t=l[e]=s[e](i),t.c()),E(t,1),t.m(a.parentNode,a))},i(i){f||(E(t),f=!0)},o(i){S(t),f=!1},d(i){i&&d(a),l[e].d(i)}}}function ot(r){let e,t,a,f,s,l,n=r[0].creatorName+"",i,_,u,g,V,I,T,v,c,m,$,N,G=re(r[0].created)+"",X,J,z,K,he,te,ae,ne=r[0].title+"",ue,de,le,se,Q,Y;a=new ce({props:{for:"creator",$$slots:{default:[Ue]},$$scope:{ctx:r}}}),g=new ce({props:{for:"status",$$slots:{default:[xe]},$$scope:{ctx:r}}}),I=new Qe({props:{state:r[0].status}}),c=new ce({props:{for:"creationdate",$$slots:{default:[et]},$$scope:{ctx:r}}}),K=new ce({props:{for:"title",$$slots:{default:[tt]},$$scope:{ctx:r}}});let j=r[0].affectedFiles&&Ne(r),Z=_e(r[0].correspondences),C=[];for(let o=0;o<Z.length;o+=1)C[o]=ye(Ce(r,Z,o));const Le=o=>S(C[o],1,1,()=>{C[o]=null});return Q=new Ye({props:{$$slots:{default:[nt]},$$scope:{ctx:r}}}),{c(){e=k("div"),t=k("div"),H(a.$$.fragment),f=P(),s=k("div"),l=k("p"),i=R(n),_=P(),u=k("div"),H(g.$$.fragment),V=P(),H(I.$$.fragment),T=P(),v=k("div"),H(c.$$.fragment),m=P(),$=k("div"),N=k("p"),X=R(G),J=P(),z=k("div"),H(K.$$.fragment),he=P(),te=k("div"),ae=k("p"),ue=R(ne),de=P(),j&&j.c(),le=P();for(let o=0;o<C.length;o+=1)C[o].c();se=P(),H(Q.$$.fragment),this.h()},l(o){e=w(o,"DIV",{class:!0});var p=D(e);t=w(p,"DIV",{});var q=D(t);M(a.$$.fragment,q),f=A(q),s=w(q,"DIV",{id:!0,class:!0});var oe=D(s);l=w(oe,"P",{class:!0});var ie=D(l);i=O(ie,n),ie.forEach(d),oe.forEach(d),q.forEach(d),_=A(p),u=w(p,"DIV",{});var U=D(u);M(g.$$.fragment,U),V=A(U),M(I.$$.fragment,U),U.forEach(d),T=A(p),v=w(p,"DIV",{});var x=D(v);M(c.$$.fragment,x),m=A(x),$=w(x,"DIV",{id:!0,class:!0});var fe=D($);N=w(fe,"P",{class:!0});var F=D(N);X=O(F,G),F.forEach(d),fe.forEach(d),x.forEach(d),p.forEach(d),J=A(o),z=w(o,"DIV",{});var ee=D(z);M(K.$$.fragment,ee),he=A(ee),te=w(ee,"DIV",{id:!0});var be=D(te);ae=w(be,"P",{class:!0});var we=D(ae);ue=O(we,ne),we.forEach(d),be.forEach(d),ee.forEach(d),de=A(o),j&&j.l(o),le=A(o);for(let $e=0;$e<C.length;$e+=1)C[$e].l(o);se=A(o),M(Q.$$.fragment,o),this.h()},h(){b(l,"class","text-sm"),b(s,"id","creator"),b(s,"class","border rounded-md flex"),b(N,"class","text-sm"),b($,"id","creationdate"),b($,"class","border rounded-md flex"),b(e,"class","grid gap-4 sm:grid-cols-3 grid-cols-2 border rounded-md m-1 p-1"),b(ae,"class","p-2 border rounded-md"),b(te,"id","title")},m(o,p){y(o,e,p),h(e,t),L(a,t,null),h(t,f),h(t,s),h(s,l),h(l,i),h(e,_),h(e,u),L(g,u,null),h(u,V),L(I,u,null),h(e,T),h(e,v),L(c,v,null),h(v,m),h(v,$),h($,N),h(N,X),y(o,J,p),y(o,z,p),L(K,z,null),h(z,he),h(z,te),h(te,ae),h(ae,ue),y(o,de,p),j&&j.m(o,p),y(o,le,p);for(let q=0;q<C.length;q+=1)C[q]&&C[q].m(o,p);y(o,se,p),L(Q,o,p),Y=!0},p(o,p){const q={};p&524288&&(q.$$scope={dirty:p,ctx:o}),a.$set(q),(!Y||p&1)&&n!==(n=o[0].creatorName+"")&&W(i,n);const oe={};p&524288&&(oe.$$scope={dirty:p,ctx:o}),g.$set(oe);const ie={};p&1&&(ie.state=o[0].status),I.$set(ie);const U={};p&524288&&(U.$$scope={dirty:p,ctx:o}),c.$set(U),(!Y||p&1)&&G!==(G=re(o[0].created)+"")&&W(X,G);const x={};if(p&524288&&(x.$$scope={dirty:p,ctx:o}),K.$set(x),(!Y||p&1)&&ne!==(ne=o[0].title+"")&&W(ue,ne),o[0].affectedFiles?j?(j.p(o,p),p&1&&E(j,1)):(j=Ne(o),j.c(),E(j,1),j.m(le.parentNode,le)):j&&(me(),S(j,1,1,()=>{j=null}),pe()),p&1){Z=_e(o[0].correspondences);let F;for(F=0;F<Z.length;F+=1){const ee=Ce(o,Z,F);C[F]?(C[F].p(ee,p),E(C[F],1)):(C[F]=ye(ee),C[F].c(),E(C[F],1),C[F].m(se.parentNode,se))}for(me(),F=Z.length;F<C.length;F+=1)Le(F);pe()}const fe={};p&524301&&(fe.$$scope={dirty:p,ctx:o}),Q.$set(fe)},i(o){if(!Y){E(a.$$.fragment,o),E(g.$$.fragment,o),E(I.$$.fragment,o),E(c.$$.fragment,o),E(K.$$.fragment,o),E(j);for(let p=0;p<Z.length;p+=1)E(C[p]);E(Q.$$.fragment,o),Y=!0}},o(o){S(a.$$.fragment,o),S(g.$$.fragment,o),S(I.$$.fragment,o),S(c.$$.fragment,o),S(K.$$.fragment,o),S(j),C=C.filter(Boolean);for(let p=0;p<C.length;p+=1)S(C[p]);S(Q.$$.fragment,o),Y=!1},d(o){o&&(d(e),d(J),d(z),d(de),d(le),d(se)),B(a),B(g),B(I),B(c),B(K),j&&j.d(o),Fe(C,o),B(Q,o)}}}function it(r){let e,t;return e=new Xe({props:{class:"overflow-y-auto",$$slots:{default:[ot]},$$scope:{ctx:r}}}),{c(){H(e.$$.fragment)},l(a){M(e.$$.fragment,a)},m(a,f){L(e,a,f),t=!0},p(a,f){const s={};f&524301&&(s.$$scope={dirty:f,ctx:a}),e.$set(s)},i(a){t||(E(e.$$.fragment,a),t=!0)},o(a){S(e.$$.fragment,a),t=!1},d(a){B(e,a)}}}function ft(r){let e,t,a;function f(l){r[9](l)}let s={$$slots:{default:[it]},$$scope:{ctx:r}};return r[1]!==void 0&&(s.open=r[1]),e=new Ge({props:s}),je.push(()=>Ae(e,"open",f)),{c(){H(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,n){L(e,l,n),a=!0},p(l,[n]){const i={};n&524301&&(i.$$scope={dirty:n,ctx:l}),!t&&n&2&&(t=!0,i.open=l[1],Pe(()=>t=!1)),e.$set(i)},i(l){a||(E(e.$$.fragment,l),a=!0)},o(l){S(e.$$.fragment,l),a=!1},d(l){B(e,l)}}}function ct(r){let e="";const t=new Uint8Array(r),a=t.byteLength;for(let f=0;f<a;f++)e+=String.fromCharCode(t[f]);return window.btoa(e)}function ut(r){return new Promise((e,t)=>{const a=new FileReader;a.onload=()=>e(a.result),a.onerror=t,a.readAsArrayBuffer(r)}).then(e=>new Uint8Array(e))}function dt(r,e,t){let a;Re(r,We,c=>t(11,a=c));let{data:f}=e,{open:s=!1}=e,l="",n=null,i=!1;const _=(a==null?void 0:a.firstName)+" "+(a==null?void 0:a.lastName);async function u(){t(3,i=!0);let c=null;n&&(c=await(await fetch(`${Ee}/api/files/uploadAttachment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([{fileName:n.name,Name:"",contentType:n.type,data:ct(await ut(n))}])})).json());let m=await fetch(`${Ee}/api/tickets/AddMessage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ticketId:f.id,newStatus:(a==null?void 0:a.creatorId)===f.creatorId?ge.awaitingStaff:ge.awaitingUser,correspondence:c!==null?{message:l,attachment:c[0],senderId:a==null?void 0:a.creatorId,senderName:_}:{message:l,senderId:a==null?void 0:a.creatorId,senderName:_}})});if(m.ok){const $=await m.json();t(0,f=$)}t(3,i=!1),t(2,l=""),n=null}async function g(c){const m=c==null?void 0:c.target;if(m.files){if(m.files.length>1){Te.error("maximum of 1 images",{position:"top-right"});return}for(let $=0;$<m.files.length;$++)if(m.files[$].size>5e6){Te.error("maximum file size of 5MB exceeded",{position:"top-right"});return}for(let $=0;$<m.files.length;$++)n=m.files[0]}}function V(c){l=c,t(2,l)}const I=c=>g(c),T=()=>u();function v(c){s=c,t(1,s)}return r.$$set=c=>{"data"in c&&t(0,f=c.data),"open"in c&&t(1,s=c.open)},[f,s,l,i,u,g,V,I,T,v]}class yt extends Me{constructor(e){super(),He(this,e,dt,ft,Oe,{data:0,open:1})}}export{yt as default};
