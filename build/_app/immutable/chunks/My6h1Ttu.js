var xe=Object.defineProperty;var et=(r,e,t)=>e in r?xe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var d=(r,e,t)=>et(r,typeof e!="symbol"?e+"":e,t);import{s as J,q as tt,u as st,r as nt,v as rt,P as me,k as Ee,N as B,Q as ot,d as D,i as O,y as E,a3 as V,l as q,w as it,p as lt,m as Fe,n as L,a as Re,f as ve,t as je}from"./qLIpCCSV.js";import{S as W,i as X,t as m,a as b,g as G,c as K,d as A,f as S,m as I,e as T,b as Ae}from"./Bpqo0lwe.js";import{e as we}from"./Dvl1x7Q7.js";import{g as Q,a as Z}from"./CgU5AtxT.js";import{i as ce,U as at}from"./C7vOgjAg.js";import{d as _,r as N,w as v}from"./CWqQW7tL.js";const Se=r=>{const e=Object.entries(r),t=e.map(([s])=>s);return _(e.map(([,s])=>s),s=>Object.fromEntries(s.map((n,i)=>[t[i],n])))},ct=r=>r&1,ut=r=>({}),ye=r=>({...r[0]});function dt(r){let e;const t=r[3].default,s=tt(t,r,r[2],ye);return{c(){s&&s.c()},l(n){s&&s.l(n)},m(n,i){s&&s.m(n,i),e=!0},p(n,[i]){s&&s.p&&(!e||i&5)&&st(s,t,n,n[2],ct(i)||!e?nt(n[2]):rt(t,n[2],i,ut),ye)},i(n){e||(b(s,n),e=!0)},o(n){m(s,n),e=!1},d(n){s&&s.d(n)}}}function ft(r,e,t){const s=[];let n=me(e,s),i,{$$slots:l={},$$scope:o}=e;const a=Se(n);return Ee(r,a,c=>t(0,i=c)),r.$$set=c=>{e=B(B({},e),ot(c)),t(4,n=me(e,s)),"$$scope"in c&&t(2,o=c.$$scope)},[i,a,o,l]}class ht extends W{constructor(e){super(),X(this,e,ft,dt,J,{})}}function $e(r,e,t){const s=r.slice();return s[5]=e[t],s}function pt(r){let e,t,s;const n=[r[2]??{}];var i=r[1].component;function l(o,a){let c={$$slots:{default:[gt]},$$scope:{ctx:o}};for(let f=0;f<n.length;f+=1)c=B(c,n[f]);return a!==void 0&&a&4&&(c=B(c,Q(n,[Z(o[2]??{})]))),{props:c}}return i&&(e=V(i,l(r)),r[4](e)),{c(){e&&S(e.$$.fragment),t=E()},l(o){e&&T(e.$$.fragment,o),t=E()},m(o,a){e&&I(e,o,a),O(o,t,a),s=!0},p(o,a){if(a&2&&i!==(i=o[1].component)){if(e){G();const c=e;m(c.$$.fragment,1,0,()=>{A(c,1)}),K()}i?(e=V(i,l(o,a)),o[4](e),S(e.$$.fragment),b(e.$$.fragment,1),I(e,t.parentNode,t)):e=null}else if(i){const c=a&4?Q(n,[Z(o[2]??{})]):{};a&258&&(c.$$scope={dirty:a,ctx:o}),e.$set(c)}},i(o){s||(e&&b(e.$$.fragment,o),s=!0)},o(o){e&&m(e.$$.fragment,o),s=!1},d(o){o&&D(t),r[4](null),e&&A(e,o)}}}function _t(r){let e,t,s;const n=[r[2]??{}];var i=r[1].component;function l(o,a){let c={};for(let f=0;f<n.length;f+=1)c=B(c,n[f]);return a!==void 0&&a&4&&(c=B(c,Q(n,[Z(o[2]??{})]))),{props:c}}return i&&(e=V(i,l(r)),r[3](e)),{c(){e&&S(e.$$.fragment),t=E()},l(o){e&&T(e.$$.fragment,o),t=E()},m(o,a){e&&I(e,o,a),O(o,t,a),s=!0},p(o,a){if(a&2&&i!==(i=o[1].component)){if(e){G();const c=e;m(c.$$.fragment,1,0,()=>{A(c,1)}),K()}i?(e=V(i,l(o,a)),o[3](e),S(e.$$.fragment),b(e.$$.fragment,1),I(e,t.parentNode,t)):e=null}else if(i){const c=a&4?Q(n,[Z(o[2]??{})]):{};e.$set(c)}},i(o){s||(e&&b(e.$$.fragment,o),s=!0)},o(o){e&&m(e.$$.fragment,o),s=!1},d(o){o&&D(t),r[3](null),e&&A(e,o)}}}function ke(r){let e,t;return e=new St({props:{of:r[5]}}),{c(){S(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,n){I(e,s,n),t=!0},p(s,n){const i={};n&2&&(i.of=s[5]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){m(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function gt(r){let e,t,s=we(r[1].children),n=[];for(let l=0;l<s.length;l+=1)n[l]=ke($e(r,s,l));const i=l=>m(n[l],1,1,()=>{n[l]=null});return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=E()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=E()},m(l,o){for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(l,o);O(l,e,o),t=!0},p(l,o){if(o&2){s=we(l[1].children);let a;for(a=0;a<s.length;a+=1){const c=$e(l,s,a);n[a]?(n[a].p(c,o),b(n[a],1)):(n[a]=ke(c),n[a].c(),b(n[a],1),n[a].m(e.parentNode,e))}for(G(),a=s.length;a<n.length;a+=1)i(a);K()}},i(l){if(!t){for(let o=0;o<s.length;o+=1)b(n[o]);t=!0}},o(l){n=n.filter(Boolean);for(let o=0;o<n.length;o+=1)m(n[o]);t=!1},d(l){l&&D(e),it(n,l)}}}function bt(r){let e,t,s,n;const i=[_t,pt],l=[];function o(a,c){return a[1].children.length===0?0:1}return e=o(r),t=l[e]=i[e](r),{c(){t.c(),s=E()},l(a){t.l(a),s=E()},m(a,c){l[e].m(a,c),O(a,s,c),n=!0},p(a,[c]){let f=e;e=o(a),e===f?l[e].p(a,c):(G(),m(l[f],1,1,()=>{l[f]=null}),K(),t=l[e],t?t.p(a,c):(t=l[e]=i[e](a),t.c()),b(t,1),t.m(s.parentNode,s))},i(a){n||(b(t),n=!0)},o(a){m(t),n=!1},d(a){a&&D(s),l[e].d(a)}}}function mt(r,e,t){let{instance:s=void 0}=e,{config:n}=e,{props:i=void 0}=e;function l(a){q[a?"unshift":"push"](()=>{s=a,t(0,s)})}function o(a){q[a?"unshift":"push"](()=>{s=a,t(0,s)})}return r.$$set=a=>{"instance"in a&&t(0,s=a.instance),"config"in a&&t(1,n=a.config),"props"in a&&t(2,i=a.props)},[s,n,i,l,o]}class Ie extends W{constructor(e){super(),X(this,e,mt,bt,J,{instance:0,config:1,props:2})}}function wt(r){let e,t,s;function n(l){r[3](l)}let i={config:r[0],props:r[0].props};return r[1]!==void 0&&(i.instance=r[1]),e=new Ie({props:i}),q.push(()=>Ae(e,"instance",n)),{c(){S(e.$$.fragment)},l(l){T(e.$$.fragment,l)},m(l,o){I(e,l,o),s=!0},p(l,o){const a={};o&1&&(a.config=l[0]),o&1&&(a.props=l[0].props),!t&&o&2&&(t=!0,a.instance=l[1],Fe(()=>t=!1)),e.$set(a)},i(l){s||(b(e.$$.fragment,l),s=!0)},o(l){m(e.$$.fragment,l),s=!1},d(l){A(e,l)}}}function yt(r){let e,t;return e=new ht({props:{props:r[0].props,$$slots:{default:[$t,({props:s})=>({4:s}),({props:s})=>s?16:0]},$$scope:{ctx:r}}}),{c(){S(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,n){I(e,s,n),t=!0},p(s,n){const i={};n&1&&(i.props=s[0].props),n&51&&(i.$$scope={dirty:n,ctx:s}),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){m(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function $t(r){let e,t,s;function n(l){r[2](l)}let i={config:r[0],props:r[4]};return r[1]!==void 0&&(i.instance=r[1]),e=new Ie({props:i}),q.push(()=>Ae(e,"instance",n)),{c(){S(e.$$.fragment)},l(l){T(e.$$.fragment,l)},m(l,o){I(e,l,o),s=!0},p(l,o){const a={};o&1&&(a.config=l[0]),o&16&&(a.props=l[4]),!t&&o&2&&(t=!0,a.instance=l[1],Fe(()=>t=!1)),e.$set(a)},i(l){s||(b(e.$$.fragment,l),s=!0)},o(l){m(e.$$.fragment,l),s=!1},d(l){A(e,l)}}}function kt(r){let e,t,s,n,i;const l=[yt,wt],o=[];function a(c,f){return f&1&&(e=null),e==null&&(e=!!ce(c[0].props)),e?0:1}return t=a(r,-1),s=o[t]=l[t](r),{c(){s.c(),n=E()},l(c){s.l(c),n=E()},m(c,f){o[t].m(c,f),O(c,n,f),i=!0},p(c,[f]){let w=t;t=a(c,f),t===w?o[t].p(c,f):(G(),m(o[w],1,1,()=>{o[w]=null}),K(),s=o[t],s?s.p(c,f):(s=o[t]=l[t](c),s.c()),b(s,1),s.m(n.parentNode,n))},i(c){i||(b(s),i=!0)},o(c){m(s),i=!1},d(c){c&&D(n),o[t].d(c)}}}function Ct(r,e,t){let{config:s}=e,n;lt(function(){return s.eventHandlers.forEach(([a,c])=>{const f=n.$$.callbacks[a]??[];f.push(c),t(1,n.$$.callbacks[a]=f,n)}),function(){s.eventHandlers.forEach(([c,f])=>{const w=n.$$.callbacks[c],H=w.findIndex(g=>g===f);w.splice(H,1)})}});function i(o){n=o,t(1,n)}function l(o){n=o,t(1,n)}return r.$$set=o=>{"config"in o&&t(0,s=o.config)},[s,n,i,l]}class Et extends W{constructor(e){super(),X(this,e,Ct,kt,J,{config:0})}}function Ft(r){let e,t;return e=new Et({props:{config:r[0]}}),{c(){S(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,n){I(e,s,n),t=!0},p(s,n){const i={};n&1&&(i.config=s[0]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){m(e.$$.fragment,s),t=!1},d(s){A(e,s)}}}function Rt(r){let e;return{c(){e=je(r[0])},l(t){e=ve(t,r[0])},m(t,s){O(t,e,s)},p(t,s){s&1&&Re(e,t[0])},i:L,o:L,d(t){t&&D(e)}}}function vt(r){let e;return{c(){e=je(r[1])},l(t){e=ve(t,r[1])},m(t,s){O(t,e,s)},p(t,s){s&2&&Re(e,t[1])},i:L,o:L,d(t){t&&D(e)}}}function jt(r){let e,t,s,n,i;const l=[vt,Rt,Ft],o=[];function a(c,f){return f&1&&(e=null),e==null&&(e=!!ce(c[0])),e?0:typeof c[0]!="object"?1:2}return t=a(r,-1),s=o[t]=l[t](r),{c(){s.c(),n=E()},l(c){s.l(c),n=E()},m(c,f){o[t].m(c,f),O(c,n,f),i=!0},p(c,[f]){let w=t;t=a(c,f),t===w?o[t].p(c,f):(G(),m(o[w],1,1,()=>{o[w]=null}),K(),s=o[t],s?s.p(c,f):(s=o[t]=l[t](c),s.c()),b(s,1),s.m(n.parentNode,n))},i(c){i||(b(s),i=!0)},o(c){m(s),i=!1},d(c){c&&D(n),o[t].d(c)}}}function At(r,e,t){let s,{of:n}=e;const i=ce(n)?n:at;return Ee(r,i,l=>t(1,s=l)),r.$$set=l=>{"of"in l&&t(0,n=l.of)},[n,s,i]}class St extends W{constructor(e){super(),X(this,e,At,jt,J,{of:0})}}class He{constructor({header:e,footer:t,height:s,plugins:n}){d(this,"header");d(this,"footer");d(this,"height");d(this,"plugins");this.header=e,this.footer=t,this.height=s,this.plugins=n}isFlat(){return"__flat"in this}isData(){return"__data"in this}isDisplay(){return"__display"in this}isGroup(){return"__group"in this}}class Pe extends He{constructor({header:t,footer:s,plugins:n,id:i}){super({header:t,footer:s,plugins:n,height:1});d(this,"__flat",!0);d(this,"id");this.id=i??String(t)}}class It extends Pe{constructor({header:t,footer:s,plugins:n,cell:i,accessor:l,id:o}){super({header:t,footer:s,plugins:n,id:"Initialization not complete"});d(this,"__data",!0);d(this,"cell");d(this,"accessorKey");d(this,"accessorFn");if(this.cell=i,l instanceof Function?this.accessorFn=l:this.accessorKey=l,o===void 0&&this.accessorKey===void 0&&t===void 0)throw new Error("A column id, string accessor, or header is required");const a=typeof this.accessorKey=="string"?this.accessorKey:null;this.id=o??a??String(t)}getValue(t){if(this.accessorFn!==void 0)return this.accessorFn(t);if(this.accessorKey!==void 0)return t[this.accessorKey]}}class Ht extends Pe{constructor({header:t,footer:s,plugins:n,id:i,cell:l,data:o}){super({header:t,footer:s,plugins:n,id:i});d(this,"__display",!0);d(this,"cell");d(this,"data");this.cell=l,this.data=o}}class Pt extends He{constructor({header:t,footer:s,columns:n,plugins:i}){const l=Math.max(...n.map(o=>o.height))+1;super({header:t,footer:s,height:l,plugins:i});d(this,"__group",!0);d(this,"columns");d(this,"ids");this.columns=n,this.ids=Me(n)}}const Me=r=>r.flatMap(e=>e.isFlat()?[e.id]:e.isGroup()?e.ids:[]),De=r=>r.flatMap(e=>e.isFlat()?[e]:e.isGroup()?De(e.columns):[]),Mt=r=>{const e=new Map;return r.forEach(t=>{e.set(t,(e.get(t)??0)+1)}),e},Dt=r=>Array.from(Mt(r).entries()).filter(([,e])=>e!==1).map(([e])=>e),Ot=r=>Object.entries(r).map(([e,t])=>`${e}:${t}`).join(";"),Tt=(r,e)=>r.style===void 0&&e.style===void 0?{...r,...e}:{...r,...e,style:{...typeof r.style=="object"?r.style:{},...typeof e.style=="object"?e.style:{}}},U=r=>r.style===void 0||typeof r.style!="object"?r:{...r,style:Ot(r.style)};class Y{constructor({id:e}){d(this,"id");d(this,"attrsForName",{});d(this,"propsForName",{});d(this,"state");this.id=e}attrs(){return _(Object.values(this.attrsForName),e=>{let t={};return e.forEach(s=>{t=Tt(t,s)}),U(t)})}props(){return Se(this.propsForName)}injectState(e){this.state=e}applyHook(e,t){t.props!==void 0&&(this.propsForName[e]=t.props),t.attrs!==void 0&&(this.attrsForName[e]=t.attrs)}}class Oe extends Y{constructor({id:t,row:s}){super({id:t});d(this,"row");this.row=s}attrs(){return _(super.attrs(),t=>({...t,role:"cell"}))}rowColId(){return`${this.row.id}:${this.column.id}`}dataRowColId(){if(this.row.isData())return`${this.row.dataId}:${this.column.id}`}isData(){return"__data"in this}isDisplay(){return"__display"in this}}class ue extends Oe{constructor({row:t,column:s,label:n,value:i}){super({id:s.id,row:t});d(this,"__data",!0);d(this,"column");d(this,"label");d(this,"value");this.column=s,this.label=n,this.value=i}render(){if(this.label===void 0)return`${this.value}`;if(this.state===void 0)throw new Error("Missing `state` reference");return this.label(this,this.state)}clone(){return new ue({row:this.row,column:this.column,label:this.label,value:this.value})}}class de extends Oe{constructor({row:t,column:s,label:n}){super({id:s.id,row:t});d(this,"__display",!0);d(this,"column");d(this,"label");this.column=s,this.label=n}render(){if(this.state===void 0)throw new Error("Missing `state` reference");return this.label(this,this.state)}clone(){return new de({row:this.row,column:this.column,label:this.label})}}const os=r=>r!==null,M=r=>r!==void 0;class Bt extends Y{constructor({id:t,cells:s,cellForId:n,depth:i=0,parentRow:l}){super({id:t});d(this,"cells");d(this,"cellForId");d(this,"depth");d(this,"parentRow");d(this,"subRows");this.cells=s,this.cellForId=n,this.depth=i,this.parentRow=l}attrs(){return _(super.attrs(),t=>({...t,role:"row"}))}isData(){return"__data"in this}isDisplay(){return"__display"in this}}class fe extends Bt{constructor({id:t,dataId:s,original:n,cells:i,cellForId:l,depth:o=0,parentRow:a}){super({id:t,cells:i,cellForId:l,depth:o,parentRow:a});d(this,"__data",!0);d(this,"dataId");d(this,"original");this.dataId=s,this.original=n}clone({includeCells:t=!1,includeSubRows:s=!1}={}){var i;const n=new fe({id:this.id,dataId:this.dataId,cellForId:this.cellForId,cells:this.cells,original:this.original,depth:this.depth});if(t){const l=Object.fromEntries(Object.entries(n.cellForId).map(([a,c])=>{const f=c.clone();return f.row=n,[a,f]})),o=n.cells.map(({id:a})=>l[a]);n.cellForId=l,n.cells=o}if(s){const l=(i=this.subRows)==null?void 0:i.map(o=>o.clone({includeCells:t,includeSubRows:s}));n.subRows=l}else n.subRows=this.subRows;return n}}const Gt=(r,e,{rowDataId:t}={})=>{const s=r.map((n,i)=>{const l=i.toString();return new fe({id:l,dataId:t!==void 0?t(n,i):l,original:n,cells:[],cellForId:{}})});return r.forEach((n,i)=>{const l=e.map(o=>{if(o.isData()){const a=o,c=a.getValue(n);return new ue({row:s[i],column:a,label:o.cell,value:c})}if(o.isDisplay()){const a=o;return new de({row:s[i],column:a,label:o.cell})}throw new Error("Unrecognized `FlatColumn` implementation")});s[i].cells=l,e.forEach((o,a)=>{s[i].cellForId[o.id]=l[a]})}),s},Kt=(r,e)=>{const t=r.map(s=>{const n=s.clone();return n.cells=[],n.cellForId={},n});return r.length===0||e.length===0?r:(r.forEach((s,n)=>{const i=s.cells.map(o=>{const a=o.clone();return a.row=t[n],a}),l=e.map(o=>i.find(a=>a.id===o)).filter(M);t[n].cells=l,i.forEach(o=>{t[n].cellForId[o.id]=o})}),t)},Te=" ";class Be extends Y{constructor({id:t,label:s,colspan:n,colstart:i}){super({id:t});d(this,"label");d(this,"colspan");d(this,"colstart");this.label=s,this.colspan=n,this.colstart=i}render(){if(this.label instanceof Function){if(this.state===void 0)throw new Error("Missing `state` reference");return this.label(this,this.state)}return this.label}attrs(){return _(super.attrs(),t=>({...t,role:"columnheader",colspan:this.colspan}))}isFlat(){return"__flat"in this}isData(){return"__data"in this}isFlatDisplay(){return"__flat"in this&&"__display"in this}isGroup(){return"__group"in this}isGroupDisplay(){return"__group"in this&&"__display"in this}}class x extends Be{constructor({id:t,label:s,colstart:n}){super({id:t,label:s,colspan:1,colstart:n});d(this,"__flat",!0)}clone(){return new x({id:this.id,label:this.label,colstart:this.colstart})}}class he extends x{constructor({id:t,label:s,accessorKey:n,accessorFn:i,colstart:l}){super({id:t,label:s,colstart:l});d(this,"__data",!0);d(this,"accessorKey");d(this,"accessorFn");this.accessorKey=n,this.accessorFn=i}clone(){return new he({id:this.id,label:this.label,accessorFn:this.accessorFn,accessorKey:this.accessorKey,colstart:this.colstart})}}class ee extends x{constructor({id:t,label:s=Te,colstart:n}){super({id:t,label:s,colstart:n});d(this,"__display",!0)}clone(){return new ee({id:this.id,label:this.label,colstart:this.colstart})}}class te extends Be{constructor({label:t,ids:s,allIds:n,colspan:i,colstart:l}){super({id:`[${s.join(",")}]`,label:t,colspan:i,colstart:l});d(this,"__group",!0);d(this,"ids");d(this,"allId");d(this,"allIds");this.ids=s,this.allId=`[${n.join(",")}]`,this.allIds=n}setIds(t){this.ids=t,this.id=`[${this.ids.join(",")}]`}pushId(t){this.ids=[...this.ids,t],this.id=`[${this.ids.join(",")}]`}clone(){return new te({label:this.label,ids:this.ids,allIds:this.allIds,colspan:this.colspan,colstart:this.colstart})}}class pe extends te{constructor({label:t=Te,ids:s,allIds:n,colspan:i=1,colstart:l}){super({label:t,ids:s,allIds:n,colspan:i,colstart:l});d(this,"__display",!0)}clone(){return new pe({label:this.label,ids:this.ids,allIds:this.allIds,colspan:this.colspan,colstart:this.colstart})}}const zt=r=>r.reduce((e,t)=>e+t,0),Ge=(r,e)=>{const t=[];for(let s=0;s<e;s++)t.push(Array(r).fill(null));return t},Ce=r=>{const e=r.length;if(e===0)return r;const t=r[0].length,s=Ge(e,t);for(let n=0;n<t;n++)for(let i=0;i<e;i++)s[n][i]=r[i][n];return s};class _e extends Y{constructor({id:t,cells:s}){super({id:t});d(this,"cells");this.cells=s}attrs(){return _(super.attrs(),t=>({...t,role:"row"}))}clone(){return new _e({id:this.id,cells:this.cells})}}const Nt=(r,e=[])=>{const t=Ut(r);let s=Ce(t);return s=Vt(s,e),qt(s),Lt(Ce(s))},Ut=r=>{const e=zt(r.map(i=>i.isGroup()?i.ids.length:1)),t=Math.max(...r.map(i=>i.height)),s=Ge(e,t);let n=0;return r.forEach(i=>{const l=t-i.height;Ke(s,i,l,n),n+=i.isGroup()?i.ids.length:1}),s.map((i,l)=>i.map((o,a)=>{var f;if(o!==null)return o;if(l===t-1)return new ee({id:a.toString(),colstart:a});const c=((f=s[t-1][a])==null?void 0:f.id)??a.toString();return new pe({ids:[],allIds:[c],colstart:a})}))},Ke=(r,e,t,s)=>{if(e.isData()){r[r.length-1][s]=new he({label:e.header,accessorFn:e.accessorFn,accessorKey:e.accessorKey,id:e.id,colstart:s});return}if(e.isDisplay()){r[r.length-1][s]=new ee({id:e.id,label:e.header,colstart:s});return}if(e.isGroup()){for(let i=0;i<e.ids.length;i++)r[t][s+i]=new te({label:e.header,colspan:1,allIds:e.ids,ids:[],colstart:s});let n=0;e.columns.forEach(i=>{Ke(r,i,t+1,s+n),n+=i.isGroup()?i.ids.length:1});return}},Vt=(r,e)=>{if(e.length===0)return r;const t=[];return e.forEach((s,n)=>{const i=r.find(l=>{const o=l[l.length-1];if(!o.isFlat())throw new Error("The last element of each column must be a `FlatHeaderCell`");return o.id===s});i!==void 0&&t.push(i.map(l=>{const o=l.clone();return o.colstart=n,o}))}),t},qt=r=>{r.forEach(e=>{const t=e[e.length-1];if(!t.isFlat())throw new Error("The last element of each column must be a `FlatHeaderCell`");e.forEach(s=>{s.isGroup()&&s.pushId(t.id)})})},Lt=r=>r.map((e,t)=>new _e({id:t.toString(),cells:Qt(e)})),Qt=r=>{if(r.length===0)return r;const e=[];let t=0,s=1;for(;t<r.length;){const n=r[t].clone();if(!n.isGroup()){e.push(n),t++;continue}s=t+1;const i=[...n.ids];for(;s<r.length;){const l=r[s];if(!l.isGroup()||n.allId!==l.allId)break;i.push(...l.ids),s++}n.setIds(i),n.colspan=s-t,e.push(n),t=s}return e},Zt=(r,e,{rowDataId:t}={})=>{const{data:s,plugins:n}=r,i=De(e),l=N(i),o=_([s,l],([u,h])=>Gt(u,h,{rowDataId:t})),a=v([]),c=v(),f=v([]),w=v([]),H=v({role:"table"}),g=v({}),$=v({role:"rowgroup"}),F={data:s,columns:e,flatColumns:i,tableAttrs:H,tableHeadAttrs:g,tableBodyAttrs:$,visibleColumns:a,headerRows:c,originalRows:o,rows:f,pageRows:w},k=Object.fromEntries(Object.entries(n).map(([u,h])=>{const p=Object.fromEntries(i.map(y=>{var R;const C=(R=y.plugins)==null?void 0:R[u];if(C!==void 0)return[y.id,C]}).filter(M));return[u,h({pluginName:u,tableState:F,columnOptions:p})]})),z=Object.fromEntries(Object.entries(k).map(([u,h])=>[u,h.pluginState])),j={data:s,columns:e,flatColumns:i,tableAttrs:H,tableHeadAttrs:g,tableBodyAttrs:$,visibleColumns:a,headerRows:c,originalRows:o,rows:f,pageRows:w,pluginStates:z},ze=Object.values(k).map(u=>u.deriveTableAttrs).filter(M);let se=N({role:"table"});ze.forEach(u=>{se=u(se)});const Ne=_(se,u=>{const h=U(u);return H.set(h),h}),Ue=Object.values(k).map(u=>u.deriveTableBodyAttrs).filter(M);let ne=N({});Ue.forEach(u=>{ne=u(ne)});const Ve=_(ne,u=>{const h=U(u);return g.set(h),h}),qe=Object.values(k).map(u=>u.deriveTableBodyAttrs).filter(M);let re=N({role:"rowgroup"});qe.forEach(u=>{re=u(re)});const Le=_(re,u=>{const h=U(u);return $.set(h),h}),Qe=Object.values(k).map(u=>u.deriveFlatColumns).filter(M);let oe=l;Qe.forEach(u=>{oe=u(oe)});const ie=_(oe,u=>(a.set(u),u)),Ze=_([o,ie],([u,h])=>Kt(u,h.map(p=>p.id))),Je=Object.values(k).map(u=>u.deriveRows).filter(M);let le=Ze;Je.forEach(u=>{le=u(le)});const ge=_(le,u=>(u.forEach(h=>{h.injectState(j),h.cells.forEach(p=>{p.injectState(j)})}),Object.entries(k).forEach(([h,p])=>{u.forEach(y=>{var C;((C=p.hooks)==null?void 0:C["tbody.tr"])!==void 0&&y.applyHook(h,p.hooks["tbody.tr"](y)),y.cells.forEach(R=>{var P;((P=p.hooks)==null?void 0:P["tbody.tr.td"])!==void 0&&R.applyHook(h,p.hooks["tbody.tr.td"](R))})})}),f.set(u),u)),We=Object.values(k).map(u=>u.derivePageRows).filter(M);let ae=ge;We.forEach(u=>{ae=u(ae)});const Xe=_(ae,u=>(u.forEach(h=>{h.injectState(j),h.cells.forEach(p=>{p.injectState(j)})}),Object.entries(k).forEach(([h,p])=>{u.forEach(y=>{var C;((C=p.hooks)==null?void 0:C["tbody.tr"])!==void 0&&y.applyHook(h,p.hooks["tbody.tr"](y)),y.cells.forEach(R=>{var P;((P=p.hooks)==null?void 0:P["tbody.tr.td"])!==void 0&&R.applyHook(h,p.hooks["tbody.tr.td"](R))})})}),w.set(u),u)),Ye=_(ie,u=>{const h=Nt(e,u.map(p=>p.id));return h.forEach(p=>{p.injectState(j),p.cells.forEach(y=>{y.injectState(j)})}),Object.entries(k).forEach(([p,y])=>{h.forEach(C=>{var R;((R=y.hooks)==null?void 0:R["thead.tr"])!==void 0&&C.applyHook(p,y.hooks["thead.tr"](C)),C.cells.forEach(P=>{var be;((be=y.hooks)==null?void 0:be["thead.tr.th"])!==void 0&&P.applyHook(p,y.hooks["thead.tr.th"](P))})})}),c.set(h),h});return{tableAttrs:Ne,tableHeadAttrs:Ve,tableBodyAttrs:Le,visibleColumns:ie,flatColumns:i,headerRows:Ye,originalRows:o,rows:ge,pageRows:Xe,pluginStates:z}};class Jt{constructor(e,t){d(this,"data");d(this,"plugins");this.data=e,this.plugins=t}createColumns(e){const t=Me(e),s=Dt(t);if(s.length!==0)throw new Error(`Duplicate column ids not allowed: "${s.join('", "')}"`);return e}column(e){return new It(e)}group(e){return new Pt(e)}display(e){return new Ht(e)}createViewModel(e,t){return Zt(this,e,t)}}const is=(r,e={})=>new Jt(r,e),Wt=1,Xt=({items:r,initialPageSize:e,initialPageIndex:t,serverSide:s,serverItemCount:n})=>{const i=v(e),l=g=>{i.update($=>{const F=g($);return Math.max(F,Wt)})},o=g=>l(()=>g),a=v(t);function c([g,$]){const F=Math.ceil($/g);return a.update(k=>F>0&&k>=F?F-1:k),F}let f;if(s&&n!=null)f=_([i,n],c);else{const g=_(r,$=>$.length);f=_([i,g],c)}const w=_(a,g=>g>0),H=_([a,f],([g,$])=>g<$-1);return{pageSize:{subscribe:i.subscribe,update:l,set:o},pageIndex:a,pageCount:f,serverItemCount:n,hasPreviousPage:w,hasNextPage:H}},ls=({initialPageIndex:r=0,initialPageSize:e=10,serverSide:t=!1,serverItemCount:s}={})=>()=>{const n=v([]),i=v([]),{pageSize:l,pageIndex:o,pageCount:a,hasPreviousPage:c,hasNextPage:f}=Xt({items:n,initialPageIndex:r,initialPageSize:e,serverSide:t,serverItemCount:s});return{pluginState:{pageSize:l,pageIndex:o,pageCount:a,hasPreviousPage:c,hasNextPage:f},derivePageRows:g=>_([g,l,o],([$,F,k])=>{if(n.set($),t)return i.set($),$;const z=k*F,j=$.slice(z,z+F);return i.set(j),j})}};export{St as R,ht as S,ls as a,is as c,os as n};
