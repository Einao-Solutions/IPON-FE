import{S as Le,i as Me,s as He,m as je,o as Ae,p as B,q as N,r as E,u as Pe,w as U,y as L,z as M,l as Oe,d,G as Fe,a as Q,F as me,v as pe,b as y,c as h,x as b,e as w,f as D,h as A,g as H,j as I,k as P,t as O,a5 as Re,a6 as qe,I as Ie,K as ve,n as ke}from"./Cccy056x.js";import{e as _e}from"./ByixyIeQ.js";import"./IHki7fMi.js";import{L as ce}from"./C1SE41V3.js";import{b as Ee,T as ge}from"./kzloY8Fw.js";import"./R6lDc60d.js";import{T as ze}from"./CXG556D5.js";import{R as Je}from"./BbVspNW5.js";import"./Mi5ChQ-_.js";import{I as Ge}from"./CyluoF3k.js";import{c as re}from"./CqGyily1.js";import{t as Te}from"./rg3ioSbs.js";import{T as Ke}from"./XLszZjwy.js";import{l as Qe}from"./DA3sRRUG.js";import{I as Be}from"./DQ1KgJGZ.js";import{S as We}from"./C8XMDHA_.js";import{S as Xe}from"./hW00L5SN.js";import{B as Ye}from"./BCzZLC02.js";function Ce(r,e,t){const l=r.slice();return l[12]=e[t],l}function De(r,e,t){const l=r.slice();return l[15]=e[t],l}function Ze(r){let e;return{c(){e=O("Created by")},l(t){e=H(t,"Created by")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function xe(r){let e;return{c(){e=O("Status")},l(t){e=H(t,"Status")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function et(r){let e;return{c(){e=O("Date Created")},l(t){e=H(t,"Date Created")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function tt(r){let e;return{c(){e=O("Title")},l(t){e=H(t,"Title")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function Se(r){let e,t,l,f;e=new ce({props:{$$slots:{default:[at]},$$scope:{ctx:r}}});let s=_e(r[0].affectedFiles),a=[];for(let n=0;n<s.length;n+=1)a[n]=Ne(De(r,s,n));return{c(){M(e.$$.fragment),t=P(),l=I("div");for(let n=0;n<a.length;n+=1)a[n].c();this.h()},l(n){L(e.$$.fragment,n),t=A(n),l=w(n,"DIV",{class:!0});var i=D(l);for(let _=0;_<a.length;_+=1)a[_].l(i);i.forEach(d),this.h()},h(){b(l,"class","grid grid-cols-2 text-sm")},m(n,i){U(e,n,i),y(n,t,i),y(n,l,i);for(let _=0;_<a.length;_+=1)a[_]&&a[_].m(l,null);f=!0},p(n,i){const _={};if(i&262144&&(_.$$scope={dirty:i,ctx:n}),e.$set(_),i&1){s=_e(n[0].affectedFiles);let u;for(u=0;u<s.length;u+=1){const g=De(n,s,u);a[u]?a[u].p(g,i):(a[u]=Ne(g),a[u].c(),a[u].m(l,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=s.length}},i(n){f||(E(e.$$.fragment,n),f=!0)},o(n){N(e.$$.fragment,n),f=!1},d(n){n&&(d(t),d(l)),B(e,n),Fe(a,n)}}}function at(r){let e;return{c(){e=O("Affected Files")},l(t){e=H(t,"Affected Files")},m(t,l){y(t,e,l)},d(t){t&&d(e)}}}function Ne(r){let e,t=r[15].fileNumber+"",l,f;return{c(){e=I("a"),l=O(t),this.h()},l(s){e=w(s,"A",{class:!0,href:!0});var a=D(e);l=H(a,t),a.forEach(d),this.h()},h(){b(e,"class","p-1 m-1 border rounded-md"),b(e,"href",f="/dataview?id="+r[15].id)},m(s,a){y(s,e,a),h(e,l)},p(s,a){a&1&&t!==(t=s[15].fileNumber+"")&&Q(l,t),a&1&&f!==(f="/dataview?id="+s[15].id)&&b(e,"href",f)},d(s){s&&d(e)}}}function Ve(r){let e,t,l,f;return t=new Be({props:{icon:"typcn:attachment-outline",width:"1.2rem",height:"1.2rem"}}),{c(){e=I("a"),M(t.$$.fragment),this.h()},l(s){e=w(s,"A",{target:!0,href:!0});var a=D(e);L(t.$$.fragment,a),a.forEach(d),this.h()},h(){b(e,"target","_blank"),b(e,"href",l=r[12].attachment)},m(s,a){y(s,e,a),U(t,e,null),f=!0},p(s,a){(!f||a&1&&l!==(l=s[12].attachment))&&b(e,"href",l)},i(s){f||(E(t.$$.fragment,s),f=!0)},o(s){N(t.$$.fragment,s),f=!1},d(s){s&&d(e),B(t)}}}function ye(r){let e,t,l,f=r[12].message+"",s,a,n=re(r[12].dateAdded)+"",i,_,u,g,V=r[12].senderName+"",k,T,c,$,m=r[12].attachment&&Ve(r);return{c(){e=I("div"),t=I("div"),l=new qe(!1),s=P(),a=I("p"),i=O(n),_=P(),u=I("div"),g=I("p"),k=O(V),T=P(),m&&m.c(),this.h()},l(v){e=w(v,"DIV",{class:!0});var S=D(e);t=w(S,"DIV",{class:!0});var J=D(t);l=Re(J,!1),J.forEach(d),s=A(S),a=w(S,"P",{class:!0});var W=D(a);i=H(W,n),W.forEach(d),_=A(S),u=w(S,"DIV",{class:!0});var z=D(u);g=w(z,"P",{class:!0});var q=D(g);k=H(q,V),q.forEach(d),T=A(z),m&&m.l(z),z.forEach(d),S.forEach(d),this.h()},h(){l.a=null,b(t,"class","content"),b(a,"class","mt-2 opacity-60 text-sm"),b(g,"class","opacity-50 text-sm"),b(u,"class","flex justify-between"),b(e,"class",c="p-2 m-2 rounded-md "+(r[12].senderId===r[0].creatorId?"bg-green-300":"bg-gray-300")+" "+(r[12].senderId===r[0].creatorId?"justify-end":"justify-start"))},m(v,S){y(v,e,S),h(e,t),l.m(f,t),h(e,s),h(e,a),h(a,i),h(e,_),h(e,u),h(u,g),h(g,k),h(u,T),m&&m.m(u,null),$=!0},p(v,S){(!$||S&1)&&f!==(f=v[12].message+"")&&l.p(f),(!$||S&1)&&n!==(n=re(v[12].dateAdded)+"")&&Q(i,n),(!$||S&1)&&V!==(V=v[12].senderName+"")&&Q(k,V),v[12].attachment?m?(m.p(v,S),S&1&&E(m,1)):(m=Ve(v),m.c(),E(m,1),m.m(u,null)):m&&(me(),N(m,1,1,()=>{m=null}),pe()),(!$||S&1&&c!==(c="p-2 m-2 rounded-md "+(v[12].senderId===v[0].creatorId?"bg-green-300":"bg-gray-300")+" "+(v[12].senderId===v[0].creatorId?"justify-end":"justify-start")))&&b(e,"class",c)},i(v){$||(E(m),$=!0)},o(v){N(m),$=!1},d(v){v&&d(e),m&&m.d()}}}function lt(r){let e,t,l="<p>Ticket closed, comments can&#39;t be added</p>",f,s,a,n=r[0].resolution.staffName+"",i,_,u,g=re(r[0].resolution.date)+"",V;return{c(){e=I("div"),t=I("div"),t.innerHTML=l,f=P(),s=I("p"),a=O("Closed by "),i=O(n),_=P(),u=I("p"),V=O(g),this.h()},l(k){e=w(k,"DIV",{class:!0});var T=D(e);t=w(T,"DIV",{class:!0,"data-svelte-h":!0}),ve(t)!=="svelte-16uw9v1"&&(t.innerHTML=l),f=A(T),s=w(T,"P",{class:!0});var c=D(s);a=H(c,"Closed by "),i=H(c,n),c.forEach(d),_=A(T),u=w(T,"P",{class:!0});var $=D(u);V=H($,g),$.forEach(d),T.forEach(d),this.h()},h(){b(t,"class","flex justify-center w-full items-center"),b(s,"class","mt-2"),b(u,"class","text-sm font-light"),b(e,"class","flex flex-col w-full")},m(k,T){y(k,e,T),h(e,t),h(e,f),h(e,s),h(s,a),h(s,i),h(e,_),h(e,u),h(u,V)},p(k,T){T&1&&n!==(n=k[0].resolution.staffName+"")&&Q(i,n),T&1&&g!==(g=re(k[0].resolution.date)+"")&&Q(V,g)},i:ke,o:ke,d(k){k&&d(e)}}}function st(r){let e,t,l,f,s,a,n="attachment (optional)",i,_,u,g,V;function k(c){r[6](c)}let T={class:"min-h-16 mt-2",placeholder:"Enter text"};return r[2]!==void 0&&(T.value=r[2]),t=new ze({props:T}),je.push(()=>Ae(t,"value",k)),_=new Ge({props:{id:"picture",type:"file",class:"mt-3",accept:".pdf, .jpg, .png, .jpeg",multiple:!1}}),_.$on("change",r[7]),g=new Ye({props:{$$slots:{default:[rt]},$$scope:{ctx:r}}}),g.$on("click",r[8]),{c(){e=I("div"),M(t.$$.fragment),f=P(),s=I("div"),a=I("p"),a.textContent=n,i=P(),M(_.$$.fragment),u=P(),M(g.$$.fragment),this.h()},l(c){e=w(c,"DIV",{});var $=D(e);L(t.$$.fragment,$),f=A($),s=w($,"DIV",{class:!0});var m=D(s);a=w(m,"P",{class:!0,"data-svelte-h":!0}),ve(a)!=="svelte-mf66d6"&&(a.textContent=n),i=A(m),L(_.$$.fragment,m),u=A(m),L(g.$$.fragment,m),m.forEach(d),$.forEach(d),this.h()},h(){b(a,"class","opacity-50 text-sm"),b(s,"class","flex gap-2 mt-1 items-center")},m(c,$){y(c,e,$),U(t,e,null),h(e,f),h(e,s),h(s,a),h(s,i),U(_,s,null),h(s,u),U(g,s,null),V=!0},p(c,$){const m={};!l&&$&4&&(l=!0,m.value=c[2],Pe(()=>l=!1)),t.$set(m);const v={};$&262152&&(v.$$scope={dirty:$,ctx:c}),g.$set(v)},i(c){V||(E(t.$$.fragment,c),E(_.$$.fragment,c),E(g.$$.fragment,c),V=!0)},o(c){N(t.$$.fragment,c),N(_.$$.fragment,c),N(g.$$.fragment,c),V=!1},d(c){c&&d(e),B(t),B(_),B(g)}}}function rt(r){let e,t,l,f="Send",s;return e=new Be({props:{class:r[3]?"":"hidden",icon:"line-md:loading-loop",width:"1.2rem",height:"1.2rem"}}),{c(){M(e.$$.fragment),t=P(),l=I("p"),l.textContent=f},l(a){L(e.$$.fragment,a),t=A(a),l=w(a,"P",{"data-svelte-h":!0}),ve(l)!=="svelte-my8s8q"&&(l.textContent=f)},m(a,n){U(e,a,n),y(a,t,n),y(a,l,n),s=!0},p(a,n){const i={};n&8&&(i.class=a[3]?"":"hidden"),e.$set(i)},i(a){s||(E(e.$$.fragment,a),s=!0)},o(a){N(e.$$.fragment,a),s=!1},d(a){a&&(d(t),d(l)),B(e,a)}}}function nt(r){let e,t,l,f;const s=[st,lt],a=[];function n(i,_){return i[0].status!==ge.closed?0:1}return e=n(r),t=a[e]=s[e](r),{c(){t.c(),l=Ie()},l(i){t.l(i),l=Ie()},m(i,_){a[e].m(i,_),y(i,l,_),f=!0},p(i,_){let u=e;e=n(i),e===u?a[e].p(i,_):(me(),N(a[u],1,1,()=>{a[u]=null}),pe(),t=a[e],t?t.p(i,_):(t=a[e]=s[e](i),t.c()),E(t,1),t.m(l.parentNode,l))},i(i){f||(E(t),f=!0)},o(i){N(t),f=!1},d(i){i&&d(l),a[e].d(i)}}}function ot(r){let e,t,l,f,s,a,n=r[0].creatorName+"",i,_,u,g,V,k,T,c,$,m,v,S,J=re(r[0].created)+"",W,z,q,G,$e,te,ae,ne=r[0].title+"",ue,de,le,se,K,X;l=new ce({props:{for:"creator",$$slots:{default:[Ze]},$$scope:{ctx:r}}}),g=new ce({props:{for:"status",$$slots:{default:[xe]},$$scope:{ctx:r}}}),k=new Ke({props:{state:r[0].status}}),$=new ce({props:{for:"creationdate",$$slots:{default:[et]},$$scope:{ctx:r}}}),G=new ce({props:{for:"title",$$slots:{default:[tt]},$$scope:{ctx:r}}});let j=r[0].affectedFiles&&Se(r),Y=_e(r[0].correspondences),C=[];for(let o=0;o<Y.length;o+=1)C[o]=ye(Ce(r,Y,o));const Ue=o=>N(C[o],1,1,()=>{C[o]=null});return K=new Xe({props:{$$slots:{default:[nt]},$$scope:{ctx:r}}}),{c(){e=I("div"),t=I("div"),M(l.$$.fragment),f=P(),s=I("div"),a=I("p"),i=O(n),_=P(),u=I("div"),M(g.$$.fragment),V=P(),M(k.$$.fragment),T=P(),c=I("div"),M($.$$.fragment),m=P(),v=I("div"),S=I("p"),W=O(J),z=P(),q=I("div"),M(G.$$.fragment),$e=P(),te=I("div"),ae=I("p"),ue=O(ne),de=P(),j&&j.c(),le=P();for(let o=0;o<C.length;o+=1)C[o].c();se=P(),M(K.$$.fragment),this.h()},l(o){e=w(o,"DIV",{class:!0});var p=D(e);t=w(p,"DIV",{});var R=D(t);L(l.$$.fragment,R),f=A(R),s=w(R,"DIV",{id:!0,class:!0});var oe=D(s);a=w(oe,"P",{class:!0});var ie=D(a);i=H(ie,n),ie.forEach(d),oe.forEach(d),R.forEach(d),_=A(p),u=w(p,"DIV",{});var Z=D(u);L(g.$$.fragment,Z),V=A(Z),L(k.$$.fragment,Z),Z.forEach(d),T=A(p),c=w(p,"DIV",{});var x=D(c);L($.$$.fragment,x),m=A(x),v=w(x,"DIV",{id:!0,class:!0});var fe=D(v);S=w(fe,"P",{class:!0});var F=D(S);W=H(F,J),F.forEach(d),fe.forEach(d),x.forEach(d),p.forEach(d),z=A(o),q=w(o,"DIV",{});var ee=D(q);L(G.$$.fragment,ee),$e=A(ee),te=w(ee,"DIV",{id:!0});var be=D(te);ae=w(be,"P",{class:!0});var we=D(ae);ue=H(we,ne),we.forEach(d),be.forEach(d),ee.forEach(d),de=A(o),j&&j.l(o),le=A(o);for(let he=0;he<C.length;he+=1)C[he].l(o);se=A(o),L(K.$$.fragment,o),this.h()},h(){b(a,"class","text-sm"),b(s,"id","creator"),b(s,"class","border rounded-md flex"),b(S,"class","text-sm"),b(v,"id","creationdate"),b(v,"class","border rounded-md flex"),b(e,"class","grid gap-4 sm:grid-cols-3 grid-cols-2 border rounded-md m-1 p-1"),b(ae,"class","p-2 border rounded-md"),b(te,"id","title")},m(o,p){y(o,e,p),h(e,t),U(l,t,null),h(t,f),h(t,s),h(s,a),h(a,i),h(e,_),h(e,u),U(g,u,null),h(u,V),U(k,u,null),h(e,T),h(e,c),U($,c,null),h(c,m),h(c,v),h(v,S),h(S,W),y(o,z,p),y(o,q,p),U(G,q,null),h(q,$e),h(q,te),h(te,ae),h(ae,ue),y(o,de,p),j&&j.m(o,p),y(o,le,p);for(let R=0;R<C.length;R+=1)C[R]&&C[R].m(o,p);y(o,se,p),U(K,o,p),X=!0},p(o,p){const R={};p&262144&&(R.$$scope={dirty:p,ctx:o}),l.$set(R),(!X||p&1)&&n!==(n=o[0].creatorName+"")&&Q(i,n);const oe={};p&262144&&(oe.$$scope={dirty:p,ctx:o}),g.$set(oe);const ie={};p&1&&(ie.state=o[0].status),k.$set(ie);const Z={};p&262144&&(Z.$$scope={dirty:p,ctx:o}),$.$set(Z),(!X||p&1)&&J!==(J=re(o[0].created)+"")&&Q(W,J);const x={};if(p&262144&&(x.$$scope={dirty:p,ctx:o}),G.$set(x),(!X||p&1)&&ne!==(ne=o[0].title+"")&&Q(ue,ne),o[0].affectedFiles?j?(j.p(o,p),p&1&&E(j,1)):(j=Se(o),j.c(),E(j,1),j.m(le.parentNode,le)):j&&(me(),N(j,1,1,()=>{j=null}),pe()),p&1){Y=_e(o[0].correspondences);let F;for(F=0;F<Y.length;F+=1){const ee=Ce(o,Y,F);C[F]?(C[F].p(ee,p),E(C[F],1)):(C[F]=ye(ee),C[F].c(),E(C[F],1),C[F].m(se.parentNode,se))}for(me(),F=Y.length;F<C.length;F+=1)Ue(F);pe()}const fe={};p&262157&&(fe.$$scope={dirty:p,ctx:o}),K.$set(fe)},i(o){if(!X){E(l.$$.fragment,o),E(g.$$.fragment,o),E(k.$$.fragment,o),E($.$$.fragment,o),E(G.$$.fragment,o),E(j);for(let p=0;p<Y.length;p+=1)E(C[p]);E(K.$$.fragment,o),X=!0}},o(o){N(l.$$.fragment,o),N(g.$$.fragment,o),N(k.$$.fragment,o),N($.$$.fragment,o),N(G.$$.fragment,o),N(j),C=C.filter(Boolean);for(let p=0;p<C.length;p+=1)N(C[p]);N(K.$$.fragment,o),X=!1},d(o){o&&(d(e),d(z),d(q),d(de),d(le),d(se)),B(l),B(g),B(k),B($),B(G),j&&j.d(o),Fe(C,o),B(K,o)}}}function it(r){let e,t;return e=new We({props:{class:"overflow-y-auto",$$slots:{default:[ot]},$$scope:{ctx:r}}}),{c(){M(e.$$.fragment)},l(l){L(e.$$.fragment,l)},m(l,f){U(e,l,f),t=!0},p(l,f){const s={};f&262157&&(s.$$scope={dirty:f,ctx:l}),e.$set(s)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){B(e,l)}}}function ft(r){let e,t,l;function f(a){r[9](a)}let s={$$slots:{default:[it]},$$scope:{ctx:r}};return r[1]!==void 0&&(s.open=r[1]),e=new Je({props:s}),je.push(()=>Ae(e,"open",f)),{c(){M(e.$$.fragment)},l(a){L(e.$$.fragment,a)},m(a,n){U(e,a,n),l=!0},p(a,[n]){const i={};n&262157&&(i.$$scope={dirty:n,ctx:a}),!t&&n&2&&(t=!0,i.open=a[1],Pe(()=>t=!1)),e.$set(i)},i(a){l||(E(e.$$.fragment,a),l=!0)},o(a){N(e.$$.fragment,a),l=!1},d(a){B(e,a)}}}function ct(r){let e="";const t=new Uint8Array(r),l=t.byteLength;for(let f=0;f<l;f++)e+=String.fromCharCode(t[f]);return window.btoa(e)}function ut(r){return new Promise((e,t)=>{const l=new FileReader;l.onload=()=>e(l.result),l.onerror=t,l.readAsArrayBuffer(r)}).then(e=>new Uint8Array(e))}function dt(r,e,t){let l;Oe(r,Qe,c=>t(11,l=c));let{data:f}=e,{open:s=!1}=e,a="",n=null,i=!1;async function _(){t(3,i=!0);let c=null;n&&(c=await(await fetch(`${Ee}/api/files/uploadAttachment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([{fileName:n.name,Name:"",contentType:n.type,data:ct(await ut(n))}])})).json());let $=await fetch(`${Ee}/api/tickets/AddMessage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ticketId:f.id,newStatus:l.id===f.creatorId?ge.awaitingStaff:ge.awaitingUser,correspondence:c!==null?{message:a,attachment:c[0],senderId:l.id,senderName:l.name}:{message:a,senderId:l.id,senderName:l.name}})});if($.ok){const m=await $.json();t(0,f=m)}t(3,i=!1),t(2,a=""),n=null}async function u(c){const $=c==null?void 0:c.target;if($.files){if($.files.length>1){Te.error("maximum of 1 images",{position:"top-right"});return}for(let m=0;m<$.files.length;m++)if($.files[m].size>5e6){Te.error("maximum file size of 5MB exceeded",{position:"top-right"});return}for(let m=0;m<$.files.length;m++)n=$.files[0]}}function g(c){a=c,t(2,a)}const V=c=>u(c),k=()=>_();function T(c){s=c,t(1,s)}return r.$$set=c=>{"data"in c&&t(0,f=c.data),"open"in c&&t(1,s=c.open)},[f,s,a,i,_,u,g,V,k,T]}class yt extends Le{constructor(e){super(),Me(this,e,dt,ft,He,{data:0,open:1})}}export{yt as default};
