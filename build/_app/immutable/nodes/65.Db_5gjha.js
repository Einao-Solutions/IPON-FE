import{s as oe,d as C,o as j,i as Y,b as v,c as A,e as L,A as ne,g as E,h as q,j as F,k as re,p as ie,f as te,t as ae}from"../chunks/qLIpCCSV.js";import{S as ce,i as le,d as M,t as z,a as G,m as K,e as Q,f as W}from"../chunks/Bpqo0lwe.js";import"../chunks/B7ETfSbN.js";import{g as Z}from"../chunks/sTQiEMwh.js";import{I as me}from"../chunks/DxaiNGYP.js";import{p as de}from"../chunks/4srO1X8Q.js";import{a as X,D as pe,l as ue}from"../chunks/WlDbmOKK.js";import{d as fe,b}from"../chunks/DvhB1z8p.js";import{B as ee}from"../chunks/Amalccm3.js";function he(d){let n;return{c(){n=ae("Home")},l(t){n=te(t,"Home")},m(t,a){Y(t,n,a)},d(t){t&&C(n)}}}function ge(d){let n;return{c(){n=ae("Back to Revisions")},l(t){n=te(t,"Back to Revisions")},m(t,a){Y(t,n,a)},d(t){t&&C(n)}}}function ye(d){let n;return{c(){n=ae("Next Renewal")},l(t){n=te(t,"Next Renewal")},m(t,a){Y(t,n,a)},d(t){t&&C(n)}}}function Pe(d){let n,t,a,u="Validating payment and updating status",l,g,T,y,i,P,k="Status updated successfully",U,c,f,O,h,J,p,R,x;return g=new me({props:{icon:"line-md:loading-loop",width:"1.2rem",height:"1.2rem"}}),f=new ee({props:{$$slots:{default:[he]},$$scope:{ctx:d}}}),f.$on("click",d[3]),h=new ee({props:{class:d[0]==="update"?"":"hidden",$$slots:{default:[ge]},$$scope:{ctx:d}}}),h.$on("click",d[4]),p=new ee({props:{class:d[0]==="batchrenewal"?"":"hidden",$$slots:{default:[ye]},$$scope:{ctx:d}}}),p.$on("click",d[5]),{c(){n=q("div"),t=q("div"),a=q("p"),a.textContent=u,l=F(),W(g.$$.fragment),y=F(),i=q("div"),P=q("p"),P.textContent=k,U=F(),c=q("div"),W(f.$$.fragment),O=F(),W(h.$$.fragment),J=F(),W(p.$$.fragment),this.h()},l(r){n=A(r,"DIV",{class:!0});var m=L(n);t=A(m,"DIV",{class:!0});var e=L(t);a=A(e,"P",{class:!0,"data-svelte-h":!0}),ne(a)!=="svelte-1p084ia"&&(a.textContent=u),l=E(e),Q(g.$$.fragment,e),e.forEach(C),y=E(m),i=A(m,"DIV",{class:!0});var s=L(i);P=A(s,"P",{class:!0,"data-svelte-h":!0}),ne(P)!=="svelte-wt0h5v"&&(P.textContent=k),U=E(s),c=A(s,"DIV",{class:!0});var o=L(c);Q(f.$$.fragment,o),O=E(o),Q(h.$$.fragment,o),J=E(o),Q(p.$$.fragment,o),o.forEach(C),s.forEach(C),m.forEach(C),this.h()},h(){j(a,"class","text-3xl text-green-600"),j(t,"class",T=(d[1]?"":"hidden")+" flex flex-col items-center space-y-20"),j(P,"class","text-2xl"),j(c,"class","space-y-3 space-x-4 flex flex-col"),j(i,"class",R=(d[1]?"hidden":"")+" space-y-10"),j(n,"class","h-screen items-center p-3 justify-center flex-col flex")},m(r,m){Y(r,n,m),v(n,t),v(t,a),v(t,l),K(g,t,null),v(n,y),v(n,i),v(i,P),v(i,U),v(i,c),K(f,c,null),v(c,O),K(h,c,null),v(c,J),K(p,c,null),x=!0},p(r,[m]){(!x||m&2&&T!==(T=(r[1]?"":"hidden")+" flex flex-col items-center space-y-20"))&&j(t,"class",T);const e={};m&8388608&&(e.$$scope={dirty:m,ctx:r}),f.$set(e);const s={};m&1&&(s.class=r[0]==="update"?"":"hidden"),m&8388608&&(s.$$scope={dirty:m,ctx:r}),h.$set(s);const o={};m&1&&(o.class=r[0]==="batchrenewal"?"":"hidden"),m&8388608&&(o.$$scope={dirty:m,ctx:r}),p.$set(o),(!x||m&2&&R!==(R=(r[1]?"hidden":"")+" space-y-10"))&&j(i,"class",R)},i(r){x||(G(g.$$.fragment,r),G(f.$$.fragment,r),G(h.$$.fragment,r),G(p.$$.fragment,r),x=!0)},o(r){z(g.$$.fragment,r),z(f.$$.fragment,r),z(h.$$.fragment,r),z(p.$$.fragment,r),x=!1},d(r){r&&C(n),M(g),M(f),M(h),M(p)}}}function $e(d,n,t){let a,u;re(d,de,e=>t(20,a=e)),re(d,ue,e=>t(21,u=e));let l,g,T=!0,y,i,P,k,U,c,f,O,h,J,p=!1;ie(async()=>{const e=a.url;await fe(),g=e.searchParams.get("orderID")??"231",e.searchParams.get("statuscode"),t(0,l=e.searchParams.get("paymentType")),c=e.searchParams.get("rrr"),f=e.searchParams.get("title"),J=e.searchParams.get("patentChangeType"),O=e.searchParams.get("applicantName"),h=e.searchParams.get("amount"),i=e.searchParams.get("applicationId"),t(2,y=e.searchParams.get("fileId")),P=e.searchParams.get("fileType"),U=u.id,k=u.name,p=e.searchParams.get("simulate")==="1",await R()});async function R(){if(t(1,T=!0),l=="newapplication"){const s=await(await fetch(`${b}/api/files/NewApplicationPayment`,{method:"POST",body:JSON.stringify({orderID:g,beforeStatus:2,afterStatus:3,title:f,applicantName:O,amount:h,paymentId:c,message:"Payment successful, awaiting search",user:k,userId:U,applicationType:0,fileId:y,applicationId:i,fieldToUpdate:null,newValue:null,simulate:p,fileType:parseInt(P)}),headers:{"Content-Type":"application/json"}})).json();X.set(s)}if(l==="tradecertificate"){const e=await fetch(`${b}/api/files/CertificateValidate?fileId=${y}&rrr=${c}&userId=${u.id}&userName=${u.name}`,{method:"POST"});if(e.ok){const s=await e.json();s.receiptUrl,s.ackUrl,X.set(s.data)}}if(l==="renewal"||l==="batchrenewal"||l==="dashrenewal"){const s=await(await fetch(`${b}/api/files/CreateFileRenewal`,{method:"POST",body:JSON.stringify({orderID:g,beforeStatus:2,amount:h,afterStatus:3,message:"Payment successful, awaiting search",user:k,applicantName:O,userId:U,paymentId:c,fileId:y,title:f,fieldToUpdate:null,newValue:null,simulate:p,fileType:parseInt(P)}),headers:{"Content-Type":"application/json"}})).json();console.log(s),X.set(s)}if(l==="update"){const e={orderID:g,beforeStatus:2,afterStatus:3,title:f,applicantName:O,amount:h,paymentId:c,message:"Payment successful, awaiting search",user:k,userId:U,applicationType:2,fileId:y,applicationId:i,fieldToUpdate:J,fileType:parseInt(P),simulate:p},o=await(await fetch(`${b}/api/files/UpdateApplicationStatus`,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json();X.set(o);const $=o.applicationHistory.find(I=>I.id===i),w=$.currentStatus;let N=localStorage.getItem("revisions"),_=JSON.parse(N);const S=_.data.findIndex(I=>I.id==i);_.data[S].status=w,_.data[S].statusHistory=$.statusHistory,localStorage.setItem("revisions",JSON.stringify(_))}if(l==="assignment"){const e=a.url,s=e.searchParams.get("amount"),o=e.searchParams.get("rrr");let $={newStatus:3,currentStatus:2,reason:"Payment Successful, awaiting search",userName:k,amount:s,applicationId:i,paymentId:o,userId:U,fileId:y,simulate:p};const w=await fetch(`${b}/api/assignment/PayAssignment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});w.ok&&await w.json()}if(l==="opposition"){const e=a.url,s=e.searchParams.get("name"),o=e.searchParams.get("address"),$=e.searchParams.get("email"),w=e.searchParams.get("description"),N=e.searchParams.get("number"),_=e.searchParams.get("amount"),S=e.searchParams.get("fileId"),I=u.name,H=u.id;let B={newStatus:16,currentStatus:2,reason:"payment successful, awaiting counter statement",applicationId:i,paymentId:c,amount:_,userName:I,description:w,userId:H,fileId:S,name:s,address:o,email:$,number:N,simulate:p};const D=await fetch(`${b}/api/opposition/payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});D.ok&&await D.json()}if(l==="oppositionCounter"){const e=a.url,s=e.searchParams.get("name"),o=e.searchParams.get("address"),$=e.searchParams.get("email"),w=e.searchParams.get("amount"),N=e.searchParams.get("description"),_=e.searchParams.get("number"),S=e.searchParams.get("fileUrl"),I=u.name,H=u.id;let B={oppositionID:i,paymentId:c,userName:I,userId:H,fileUrl:S,name:s,address:o,email:$,amount:w,description:N,number:_};const D=await fetch(`${b}/api/opposition/respond`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(D.ok){const V=await D.json();V.responseReceiptUrl,V.responseAckUrl}}if(l==="oppositionResolution"){const e=a.url,s=e.searchParams.get("fileUrl"),o=e.searchParams.get("amount"),$=e.searchParams.get("description"),w=u.name,N=u.id;let _={oppositionID:i,paymentId:c,userName:w,userId:N,amount:o,description:$,fileUrl:s};const S=await fetch(`${b}/api/opposition/resolution`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});if(S.ok){const I=await S.json();I.responseReceiptUrl,I.responseAckUrl}}if(l==="statussearch"){const e=a.url.searchParams.get("requestId")??void 0;await fetch(`${b}/api/files/UpdateStatusRequest?requestId=${e}&simulate=${p}`,{method:"POST"}),t(1,T=!1)}if(l==="other"){const e=a.url.searchParams.get("rrr")??void 0,s=a.url.searchParams.get("notes")??void 0,o=a.url.searchParams.get("attachmentUrl")??void 0,$=a.url.searchParams.get("title")??void 0,w=a.url.searchParams.get("serviceId")??void 0,N=a.url.searchParams.get("amount")??void 0,_=a.url.searchParams.get("agentName")??void 0,S=a.url.searchParams.get("agentId")??void 0,I=a.url.searchParams.get("name")??void 0,H=a.url.searchParams.get("number")??void 0,B=a.url.searchParams.get("email")??void 0,D=crypto.randomUUID();let V={agentId:S,agentName:_,serviceId:w,serviceName:$,amount:N,rrr:e,name:I,email:B,number:H,id:D};s!=="undefined"&&(V.notes=s),o&&(V.attachmentUrl=o);const se=await(await fetch(`${b}/api/payments/SaveOtherPayment`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(V)})).json();se.receiptUrl,se.ackUrl}t(1,T=!1)}return[l,T,y,()=>{pe.set(null),Z("/home/dashboard/")},()=>{Z(`/updatesmade?id=${y}`)},()=>{Z("/payment?type=batchrenewal")}]}class Oe extends ce{constructor(n){super(),le(this,n,$e,Pe,oe,{})}}export{Oe as component};
